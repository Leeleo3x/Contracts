{"Runs": "200", "SwarmSource": "bzzr://f6ba3c935283d670d1658498515bfda3edb44c753ea9ce9b5bc3def8954e0c0c", "ABI": "[{\"constant\":true,\"inputs\":[{\"name\":\"_interfaceId\",\"type\":\"bytes4\"}],\"name\":\"supportsInterface\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getApproved\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_approved\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"cardArray\",\"outputs\":[{\"name\":\"protoId\",\"type\":\"uint16\"},{\"name\":\"hero\",\"type\":\"uint16\"},{\"name\":\"quality\",\"type\":\"uint16\"},{\"name\":\"feature\",\"type\":\"uint16\"},{\"name\":\"level\",\"type\":\"uint16\"},{\"name\":\"attrExt1\",\"type\":\"uint16\"},{\"name\":\"attrExt2\",\"type\":\"uint16\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalSupply\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"safeTransferByContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"name\":\"_idxArray\",\"type\":\"uint16[5]\"},{\"name\":\"_params\",\"type\":\"uint16[5]\"},{\"name\":\"_changeType\",\"type\":\"uint16\"}],\"name\":\"changeCardAttr\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"doUnpause\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokens\",\"type\":\"uint256[]\"}],\"name\":\"getCardAttrs\",\"outputs\":[{\"name\":\"attrs\",\"type\":\"uint16[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"safeTransferFrom\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"name\":\"_deleteType\",\"type\":\"uint16\"}],\"name\":\"destroyCard\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_actionAddr\",\"type\":\"address\"}],\"name\":\"getActionContract\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_attrs\",\"type\":\"uint16[5]\"},{\"name\":\"_createType\",\"type\":\"uint16\"}],\"name\":\"createCard\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"ownerOf\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"doPause\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_actionAddr\",\"type\":\"address\"},{\"name\":\"_useful\",\"type\":\"bool\"}],\"name\":\"setActionContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_newAdmin\",\"type\":\"address\"}],\"name\":\"setAdmin\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getCard\",\"outputs\":[{\"name\":\"datas\",\"type\":\"uint16[7]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_operator\",\"type\":\"address\"},{\"name\":\"_approved\",\"type\":\"bool\"}],\"name\":\"setApprovalForAll\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"isPaused\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"name\":\"data\",\"type\":\"bytes\"}],\"name\":\"safeTransferFrom\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"addrAdmin\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"getOwnCard\",\"outputs\":[{\"name\":\"tokens\",\"type\":\"uint256[]\"},{\"name\":\"flags\",\"type\":\"uint32[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_operator\",\"type\":\"address\"}],\"name\":\"isApprovedForAll\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_approved\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_operator\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_approved\",\"type\":\"bool\"}],\"name\":\"ApprovalForAll\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"tokenId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"protoId\",\"type\":\"uint16\"},{\"indexed\":false,\"name\":\"hero\",\"type\":\"uint16\"},{\"indexed\":false,\"name\":\"quality\",\"type\":\"uint16\"},{\"indexed\":false,\"name\":\"createType\",\"type\":\"uint16\"}],\"name\":\"CreateCard\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"tokenId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"deleteType\",\"type\":\"uint16\"}],\"name\":\"DeleteCard\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"tokenId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"changeType\",\"type\":\"uint16\"}],\"name\":\"ChangeCard\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"preAdmin\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newAdmin\",\"type\":\"address\"}],\"name\":\"AdminTransferred\",\"type\":\"event\"}]", "Library": "", "CompilerVersion": "v0.4.23+commit.124ca40d", "ConstructorArguments": "", "SourceCode": "pragma solidity ^0.4.23;\r\n\r\n/// @title ERC-165 Standard Interface Detection\r\n/// @dev See https://github.com/ethereum/EIPs/blob/master/EIPS/eip-165.md\r\ninterface ERC165 {\r\n    function supportsInterface(bytes4 interfaceID) external view returns (bool);\r\n}\r\n\r\n/// @title ERC-721 Non-Fungible Token Standard\r\n/// @dev See https://github.com/ethereum/EIPs/blob/master/EIPS/eip-721.md\r\ncontract ERC721 is ERC165 {\r\n    event Transfer(address indexed _from, address indexed _to, uint256 _tokenId);\r\n    event Approval(address indexed _owner, address indexed _approved, uint256 _tokenId);\r\n    event ApprovalForAll(address indexed _owner, address indexed _operator, bool _approved);\r\n    function balanceOf(address _owner) external view returns (uint256);\r\n    function ownerOf(uint256 _tokenId) external view returns (address);\r\n    function safeTransferFrom(address _from, address _to, uint256 _tokenId, bytes data) external;\r\n    function safeTransferFrom(address _from, address _to, uint256 _tokenId) external;\r\n    function transferFrom(address _from, address _to, uint256 _tokenId) external;\r\n    function approve(address _approved, uint256 _tokenId) external;\r\n    function setApprovalForAll(address _operator, bool _approved) external;\r\n    function getApproved(uint256 _tokenId) external view returns (address);\r\n    function isApprovedForAll(address _owner, address _operator) external view returns (bool);\r\n}\r\n\r\n/// @title ERC-721 Non-Fungible Token Standard\r\ninterface ERC721TokenReceiver {\r\n\tfunction onERC721Received(address _from, uint256 _tokenId, bytes data) external returns(bytes4);\r\n}\r\n\r\ncontract AccessAdmin {\r\n    bool public isPaused = false;\r\n    address public addrAdmin;  \r\n\r\n    event AdminTransferred(address indexed preAdmin, address indexed newAdmin);\r\n\r\n    constructor() public {\r\n        addrAdmin = msg.sender;\r\n    }  \r\n\r\n\r\n    modifier onlyAdmin() {\r\n        require(msg.sender == addrAdmin);\r\n        _;\r\n    }\r\n\r\n    modifier whenNotPaused() {\r\n        require(!isPaused);\r\n        _;\r\n    }\r\n\r\n    modifier whenPaused {\r\n        require(isPaused);\r\n        _;\r\n    }\r\n\r\n    function setAdmin(address _newAdmin) external onlyAdmin {\r\n        require(_newAdmin != address(0));\r\n        emit AdminTransferred(addrAdmin, _newAdmin);\r\n        addrAdmin = _newAdmin;\r\n    }\r\n\r\n    function doPause() external onlyAdmin whenNotPaused {\r\n        isPaused = true;\r\n    }\r\n\r\n    function doUnpause() external onlyAdmin whenPaused {\r\n        isPaused = false;\r\n    }\r\n}\r\n\r\n//Ether League Hero Token\r\ncontract ELHeroToken is ERC721,AccessAdmin{\r\n    struct Card {\r\n        uint16 protoId;     // 0  10001-10025 Gen 0 Heroes\r\n        uint16 hero;        // 1  1-25 hero ID\r\n        uint16 quality;     // 2  rarities: 1 Common 2 Uncommon 3 Rare 4 Epic 5 Legendary 6 Gen 0 Heroes\r\n        uint16 feature;     // 3  feature\r\n        uint16 level;       // 4  level\r\n        uint16 attrExt1;    // 5  future stat 1\r\n        uint16 attrExt2;    // 6  future stat 2\r\n    }\r\n    \r\n    /// @dev All card tokenArray (not exceeding 2^32-1)\r\n    Card[] public cardArray;\r\n\r\n    /// @dev Amount of tokens destroyed\r\n    uint256 destroyCardCount;\r\n\r\n    /// @dev Card token ID vs owner address\r\n    mapping (uint256 => address) cardIdToOwner;\r\n\r\n    /// @dev cards owner by the owner (array)\r\n    mapping (address => uint256[]) ownerToCardArray;\r\n    \r\n    /// @dev card token ID search in owner array\r\n    mapping (uint256 => uint256) cardIdToOwnerIndex;\r\n\r\n    /// @dev The authorized address for each token\r\n    mapping (uint256 => address) cardIdToApprovals;\r\n\r\n    /// @dev The authorized operators for each address\r\n    mapping (address => mapping (address => bool)) operatorToApprovals;\r\n\r\n    /// @dev Trust contract\r\n    mapping (address => bool) actionContracts;\r\n\r\n    function setActionContract(address _actionAddr, bool _useful) external onlyAdmin {\r\n        actionContracts[_actionAddr] = _useful;\r\n    }\r\n\r\n    function getActionContract(address _actionAddr) external view onlyAdmin returns(bool) {\r\n        return actionContracts[_actionAddr];\r\n    }\r\n\r\n    event Transfer(address indexed _from, address indexed _to, uint256 _tokenId);\r\n    event Approval(address indexed _owner, address indexed _approved, uint256 _tokenId);\r\n    event ApprovalForAll(address indexed _owner, address indexed _operator, bool _approved);\r\n    event CreateCard(address indexed owner, uint256 tokenId, uint16 protoId, uint16 hero, uint16 quality, uint16 createType);\r\n    event DeleteCard(address indexed owner, uint256 tokenId, uint16 deleteType);\r\n    event ChangeCard(address indexed owner, uint256 tokenId, uint16 changeType);\r\n    \r\n\r\n    modifier isValidToken(uint256 _tokenId) {\r\n        require(_tokenId >= 1 && _tokenId <= cardArray.length);\r\n        require(cardIdToOwner[_tokenId] != address(0)); \r\n        _;\r\n    }\r\n\r\n    modifier canTransfer(uint256 _tokenId) {\r\n        address owner = cardIdToOwner[_tokenId];\r\n        require(msg.sender == owner || msg.sender == cardIdToApprovals[_tokenId] || operatorToApprovals[owner][msg.sender]);\r\n        _;\r\n    }\r\n\r\n    // ERC721\r\n    function supportsInterface(bytes4 _interfaceId) external view returns(bool) {\r\n        // ERC165 || ERC721 || ERC165^ERC721\r\n        return (_interfaceId == 0x01ffc9a7 || _interfaceId == 0x80ac58cd || _interfaceId == 0x8153916a) && (_interfaceId != 0xffffffff);\r\n    }\r\n\r\n    constructor() public {\r\n        addrAdmin = msg.sender;\r\n        cardArray.length += 1;\r\n    }\r\n\r\n\r\n    function name() public pure returns(string) {\r\n        return \"Ether League Hero Token\";\r\n    }\r\n\r\n    function symbol() public pure returns(string) {\r\n        return \"ELHT\";\r\n    }\r\n\r\n    /// @dev Search for token quantity address\r\n    /// @param _owner Address that needs to be searched\r\n    /// @return Returns token quantity\r\n    function balanceOf(address _owner) external view returns (uint256){\r\n        require(_owner != address(0));\r\n        return ownerToCardArray[_owner].length;\r\n    }\r\n\r\n    /// @dev Find the owner of an ELHT\r\n    /// @param _tokenId The tokenId of ELHT\r\n    /// @return Give The address of the owner of this ELHT\r\n    function ownerOf(uint256 _tokenId) external view returns (address){\r\n        return cardIdToOwner[_tokenId];\r\n    }\r\n\r\n    /// @dev Transfers the ownership of an ELHT from one address to another address\r\n    /// @param _from The current owner of the ELHT\r\n    /// @param _to The new owner\r\n    /// @param _tokenId The ELHT to transfer\r\n    /// @param data Additional data with no specified format, sent in call to `_to`\r\n    function safeTransferFrom(address _from, address _to, uint256 _tokenId, bytes data) external whenNotPaused{\r\n        _safeTransferFrom(_from, _to, _tokenId, data);\r\n    }\r\n\r\n    /// @dev Transfers the ownership of an ELHT from one address to another address\r\n    /// @param _from The current owner of the ELHT\r\n    /// @param _to The new owner\r\n    /// @param _tokenId The ELHT to transfer\r\n    function safeTransferFrom(address _from, address _to, uint256 _tokenId) external whenNotPaused{\r\n        _safeTransferFrom(_from, _to, _tokenId, \"\");\r\n    }\r\n\r\n    /// @dev Transfer ownership of an ELHT, '_to' must be a vaild address, or the ELHT will lost\r\n    /// @param _from The current owner of the ELHT\r\n    /// @param _to The new owner\r\n    /// @param _tokenId The ELHT to transfer\r\n    function transferFrom(address _from, address _to, uint256 _tokenId) external whenNotPaused isValidToken(_tokenId) canTransfer(_tokenId){\r\n        address owner = cardIdToOwner[_tokenId];\r\n        require(owner != address(0));\r\n        require(_to != address(0));\r\n        require(owner == _from);\r\n        \r\n        _transfer(_from, _to, _tokenId);\r\n    }\r\n    \r\n\r\n    /// @dev Set or reaffirm the approved address for an ELHT\r\n    /// @param _approved The new approved ELHT controller\r\n    /// @param _tokenId The ELHT to approve\r\n    function approve(address _approved, uint256 _tokenId) external whenNotPaused{\r\n        address owner = cardIdToOwner[_tokenId];\r\n        require(owner != address(0));\r\n        require(msg.sender == owner || operatorToApprovals[owner][msg.sender]);\r\n\r\n        cardIdToApprovals[_tokenId] = _approved;\r\n        emit Approval(owner, _approved, _tokenId);\r\n    }\r\n\r\n    /// @dev Enable or disable approval for a third party (\"operator\") to manage all your asset.\r\n    /// @param _operator Address to add to the set of authorized operators.\r\n    /// @param _approved True if the operators is approved, false to revoke approval\r\n    function setApprovalForAll(address _operator, bool _approved) external whenNotPaused{\r\n        operatorToApprovals[msg.sender][_operator] = _approved;\r\n        emit ApprovalForAll(msg.sender, _operator, _approved);\r\n    }\r\n\r\n    /// @dev Get the approved address for a single ELHT\r\n    /// @param _tokenId The ELHT to find the approved address for\r\n    /// @return The approved address for this ELHT, or the zero address if there is none\r\n    function getApproved(uint256 _tokenId) external view isValidToken(_tokenId) returns (address) {\r\n        return cardIdToApprovals[_tokenId];\r\n    }\r\n\r\n    /// @dev Query if an address is an authorized operator for another address \u67e5\u8be2\u5730\u5740\u662f\u5426\u4e3a\u53e6\u4e00\u5730\u5740\u7684\u6388\u6743\u64cd\u4f5c\u8005\r\n    /// @param _owner The address that owns the ELHTs\r\n    /// @param _operator The address that acts on behalf of the owner\r\n    /// @return True if `_operator` is an approved operator for `_owner`, false otherwise\r\n    function isApprovedForAll(address _owner, address _operator) external view returns (bool) {\r\n        return operatorToApprovals[_owner][_operator];\r\n    }\r\n\r\n    /// @dev Count ELHTs tracked by this contract\r\n    /// @return A count of valid ELHTs tracked by this contract, where each one of them has an assigned and queryable owner not equal to the zero address\r\n    function totalSupply() external view returns (uint256) {\r\n        return cardArray.length - destroyCardCount - 1;\r\n    }\r\n\r\n    /// @dev Actually perform the safeTransferFrom\r\n    function _safeTransferFrom(address _from, address _to, uint256 _tokenId, bytes data) internal isValidToken(_tokenId) canTransfer(_tokenId){\r\n        address owner = cardIdToOwner[_tokenId];\r\n        require(owner != address(0));\r\n        require(_to != address(0));\r\n        require(owner == _from);\r\n        \r\n        _transfer(_from, _to, _tokenId);\r\n\r\n        // Do the callback after everything is done to avoid reentrancy attack\r\n        uint256 codeSize;\r\n        assembly { codeSize := extcodesize(_to) }\r\n        if (codeSize == 0) {\r\n            return;\r\n        }\r\n        bytes4 retval = ERC721TokenReceiver(_to).onERC721Received(_from, _tokenId, data);\r\n        // bytes4(keccak256(\"onERC721Received(address,uint256,bytes)\")) = 0xf0b9e5ba;\r\n        require(retval == 0xf0b9e5ba);\r\n    }\r\n\r\n    /// @dev Do the real transfer with out any condition checking\r\n    /// @param _from The old owner of this ELHT(If created: 0x0)\r\n    /// @param _to The new owner of this ELHT \r\n    /// @param _tokenId The tokenId of the ELHT\r\n    function _transfer(address _from, address _to, uint256 _tokenId) internal {\r\n        if (_from != address(0)) {\r\n            uint256 indexFrom = cardIdToOwnerIndex[_tokenId];\r\n            uint256[] storage cdArray = ownerToCardArray[_from];\r\n            require(cdArray[indexFrom] == _tokenId);\r\n\r\n            // If the ELHT is not the element of array, change it to with the last\r\n            if (indexFrom != cdArray.length - 1) {\r\n                uint256 lastTokenId = cdArray[cdArray.length - 1];\r\n                cdArray[indexFrom] = lastTokenId; \r\n                cardIdToOwnerIndex[lastTokenId] = indexFrom;\r\n            }\r\n            cdArray.length -= 1; \r\n            \r\n            if (cardIdToApprovals[_tokenId] != address(0)) {\r\n                delete cardIdToApprovals[_tokenId];\r\n            }      \r\n        }\r\n\r\n        // Give the ELHT to '_to'\r\n        cardIdToOwner[_tokenId] = _to;\r\n        ownerToCardArray[_to].push(_tokenId);\r\n        cardIdToOwnerIndex[_tokenId] = ownerToCardArray[_to].length - 1;\r\n        \r\n        emit Transfer(_from != address(0) ? _from : this, _to, _tokenId);\r\n    }\r\n\r\n\r\n\r\n    /*----------------------------------------------------------------------------------------------------------*/\r\n\r\n\r\n    /// @dev Card creation\r\n    /// @param _owner Owner of the equipment created\r\n    /// @param _attrs Attributes of the equipment created\r\n    /// @return Token ID of the equipment created\r\n    function createCard(address _owner, uint16[5] _attrs, uint16 _createType) external whenNotPaused returns(uint256){\r\n        require(actionContracts[msg.sender]);\r\n        require(_owner != address(0));\r\n        uint256 newCardId = cardArray.length;\r\n        require(newCardId < 4294967296);\r\n\r\n        cardArray.length += 1;\r\n        Card storage cd = cardArray[newCardId];\r\n        cd.protoId = _attrs[0];\r\n        cd.hero = _attrs[1];\r\n        cd.quality = _attrs[2];\r\n        cd.feature = _attrs[3];\r\n        cd.level = _attrs[4];\r\n\r\n        _transfer(0, _owner, newCardId);\r\n        emit CreateCard(_owner, newCardId, _attrs[0], _attrs[1], _attrs[2], _createType);\r\n        return newCardId;\r\n    }\r\n\r\n    /// @dev One specific attribute of the equipment modified\r\n    function _changeAttrByIndex(Card storage _cd, uint16 _index, uint16 _val) internal {\r\n        if (_index == 2) {\r\n            _cd.quality = _val;\r\n        } else if(_index == 3) {\r\n            _cd.feature = _val;\r\n        } else if(_index == 4) {\r\n            _cd.level = _val;\r\n        } else if(_index == 5) {\r\n            _cd.attrExt1 = _val;\r\n        } else if(_index == 6) {\r\n            _cd.attrExt2 = _val;\r\n        }\r\n    }\r\n\r\n    /// @dev Equiment attributes modified (max 4 stats modified)\r\n    /// @param _tokenId Equipment Token ID\r\n    /// @param _idxArray Stats order that must be modified\r\n    /// @param _params Stat value that must be modified\r\n    /// @param _changeType Modification type such as enhance, socket, etc.\r\n    function changeCardAttr(uint256 _tokenId, uint16[5] _idxArray, uint16[5] _params, uint16 _changeType) external whenNotPaused isValidToken(_tokenId) {\r\n        require(actionContracts[msg.sender]);\r\n\r\n        Card storage cd = cardArray[_tokenId];\r\n        if (_idxArray[0] > 0) _changeAttrByIndex(cd, _idxArray[0], _params[0]);\r\n        if (_idxArray[1] > 0) _changeAttrByIndex(cd, _idxArray[1], _params[1]);\r\n        if (_idxArray[2] > 0) _changeAttrByIndex(cd, _idxArray[2], _params[2]);\r\n        if (_idxArray[3] > 0) _changeAttrByIndex(cd, _idxArray[3], _params[3]);\r\n        if (_idxArray[4] > 0) _changeAttrByIndex(cd, _idxArray[4], _params[4]);\r\n        \r\n        emit ChangeCard(cardIdToOwner[_tokenId], _tokenId, _changeType);\r\n    }\r\n\r\n    /// @dev Equipment destruction\r\n    /// @param _tokenId Equipment Token ID\r\n    /// @param _deleteType Destruction type, such as craft\r\n    function destroyCard(uint256 _tokenId, uint16 _deleteType) external whenNotPaused isValidToken(_tokenId) {\r\n        require(actionContracts[msg.sender]);\r\n\r\n        address _from = cardIdToOwner[_tokenId];\r\n        uint256 indexFrom = cardIdToOwnerIndex[_tokenId];\r\n        uint256[] storage cdArray = ownerToCardArray[_from]; \r\n        require(cdArray[indexFrom] == _tokenId);\r\n\r\n        if (indexFrom != cdArray.length - 1) {\r\n            uint256 lastTokenId = cdArray[cdArray.length - 1];\r\n            cdArray[indexFrom] = lastTokenId; \r\n            cardIdToOwnerIndex[lastTokenId] = indexFrom;\r\n        }\r\n        cdArray.length -= 1; \r\n\r\n        cardIdToOwner[_tokenId] = address(0);\r\n        delete cardIdToOwnerIndex[_tokenId];\r\n        destroyCardCount += 1;\r\n\r\n        emit Transfer(_from, 0, _tokenId);\r\n\r\n        emit DeleteCard(_from, _tokenId, _deleteType);\r\n    }\r\n\r\n    /// @dev Safe transfer by trust contracts\r\n    function safeTransferByContract(uint256 _tokenId, address _to) external whenNotPaused{\r\n        require(actionContracts[msg.sender]);\r\n\r\n        require(_tokenId >= 1 && _tokenId <= cardArray.length);\r\n        address owner = cardIdToOwner[_tokenId];\r\n        require(owner != address(0));\r\n        require(_to != address(0));\r\n        require(owner != _to);\r\n\r\n        _transfer(owner, _to, _tokenId);\r\n    }\r\n\r\n    /// @dev Get fashion attrs by tokenId\r\n    function getCard(uint256 _tokenId) external view isValidToken(_tokenId) returns (uint16[7] datas) {\r\n        Card storage cd = cardArray[_tokenId];\r\n        datas[0] = cd.protoId;\r\n        datas[1] = cd.hero;\r\n        datas[2] = cd.quality;\r\n        datas[3] = cd.feature;\r\n        datas[4] = cd.level;\r\n        datas[5] = cd.attrExt1;\r\n        datas[6] = cd.attrExt2;\r\n    }\r\n\r\n    /// Get tokenIds and flags by owner\r\n    function getOwnCard(address _owner) external view returns(uint256[] tokens, uint32[] flags) {\r\n        require(_owner != address(0));\r\n        uint256[] storage cdArray = ownerToCardArray[_owner];\r\n        uint256 length = cdArray.length;\r\n        tokens = new uint256[](length);\r\n        flags = new uint32[](length);\r\n        for (uint256 i = 0; i < length; ++i) {\r\n            tokens[i] = cdArray[i];\r\n            Card storage cd = cardArray[cdArray[i]];\r\n            flags[i] = uint32(uint32(cd.protoId) * 1000 + uint32(cd.hero) * 10 + cd.quality);\r\n        }\r\n    }\r\n\r\n    /// ELHT token info returned based on Token ID transfered (64 at most)\r\n    function getCardAttrs(uint256[] _tokens) external view returns(uint16[] attrs) {\r\n        uint256 length = _tokens.length;\r\n        require(length <= 64);\r\n        attrs = new uint16[](length * 11);\r\n        uint256 tokenId;\r\n        uint256 index;\r\n        for (uint256 i = 0; i < length; ++i) {\r\n            tokenId = _tokens[i];\r\n            if (cardIdToOwner[tokenId] != address(0)) {\r\n                index = i * 11;\r\n                Card storage cd = cardArray[tokenId];\r\n                attrs[index] = cd.hero;\r\n                attrs[index + 1] = cd.quality;\r\n                attrs[index + 2] = cd.feature;\r\n                attrs[index + 3] = cd.level;\r\n                attrs[index + 4] = cd.attrExt1;\r\n                attrs[index + 5] = cd.attrExt2;\r\n            }   \r\n        }\r\n    }\r\n\r\n\r\n}", "OptimizationUsed": "1", "ContractName": "ELHeroToken", "ByteCode": "0x6080604052600436106101695763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166301ffc9a7811461016e57806306fdde03146101a4578063081812fc1461022e578063095ea7b3146102625780631439bf4b1461028857806318160ddd146102e657806318ad052b1461030d57806319902b401461033157806323b872dd1461035557806330efb8d31461037f5780633548fcd71461039457806342842e0e146104045780634ad372411461042e5780634ea34cdb1461044d578063566e638e1461046e5780636352211e1461049857806367d0661d146104b05780636fb642de146104c5578063704b6c02146104eb57806370a082311461050c5780639188d3121461052d57806395d89b411461057d578063a22cb46514610592578063b187bd26146105b8578063b88d4fde146105cd578063bfae2f0e14610606578063e1ee92841461061b578063e985e9c5146106d5575b600080fd5b34801561017a57600080fd5b50610190600160e060020a0319600435166106fc565b604080519115158252519081900360200190f35b3480156101b057600080fd5b506101b96107af565b6040805160208082528351818301528351919283929083019185019080838360005b838110156101f35781810151838201526020016101db565b50505050905090810190601f1680156102205780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561023a57600080fd5b506102466004356107e7565b60408051600160a060020a039092168252519081900360200190f35b34801561026e57600080fd5b50610286600160a060020a0360043516602435610848565b005b34801561029457600080fd5b506102a0600435610945565b6040805161ffff988916815296881660208801529487168686015292861660608601529085166080850152841660a084015290921660c082015290519081900360e00190f35b3480156102f257600080fd5b506102fb6109bc565b60408051918252519081900360200190f35b34801561031957600080fd5b50610286600435600160a060020a03602435166109ca565b34801561033d57600080fd5b50610286600435602460c461ffff6101643516610a83565b34801561036157600080fd5b50610286600160a060020a0360043581169060243516604435610c39565b34801561038b57600080fd5b50610286610d75565b3480156103a057600080fd5b506103b46004803560248101910135610db2565b60408051602080825283518183015283519192839290830191858101910280838360005b838110156103f05781810151838201526020016103d8565b505050509050019250505060405180910390f35b34801561041057600080fd5b50610286600160a060020a0360043581169060243516604435610fa7565b34801561043a57600080fd5b5061028660043561ffff60243516610fd3565b34801561045957600080fd5b50610190600160a060020a03600435166111e6565b34801561047a57600080fd5b506102fb600160a060020a0360043516602461ffff60c43516611226565b3480156104a457600080fd5b506102466004356113f2565b3480156104bc57600080fd5b5061028661140d565b3480156104d157600080fd5b50610286600160a060020a0360043516602435151561144c565b3480156104f757600080fd5b50610286600160a060020a0360043516611497565b34801561051857600080fd5b506102fb600160a060020a036004351661153f565b34801561053957600080fd5b50610545600435611572565b604051808260e080838360005b8381101561056a578181015183820152602001610552565b5050505090500191505060405180910390f35b34801561058957600080fd5b506101b9611656565b34801561059e57600080fd5b50610286600160a060020a0360043516602435151561168d565b3480156105c457600080fd5b5061019061170b565b3480156105d957600080fd5b50610286600160a060020a0360048035821691602480359091169160443591606435908101910135611714565b34801561061257600080fd5b50610246611767565b34801561062757600080fd5b5061063c600160a060020a036004351661177b565b604051808060200180602001838103835285818151815260200191508051906020019060200280838360005b83811015610680578181015183820152602001610668565b50505050905001838103825284818151815260200191508051906020019060200280838360005b838110156106bf5781810151838201526020016106a7565b5050505090500194505050505060405180910390f35b3480156106e157600080fd5b50610190600160a060020a03600435811690602435166118e2565b60007f01ffc9a700000000000000000000000000000000000000000000000000000000600160e060020a03198316148061075f57507f80ac58cd00000000000000000000000000000000000000000000000000000000600160e060020a03198316145b8061079357507f8153916a00000000000000000000000000000000000000000000000000000000600160e060020a03198316145b80156107a95750600160e060020a031980831614155b92915050565b60408051808201909152601781527f4574686572204c6561677565204865726f20546f6b656e00000000000000000060208201525b90565b600081600181101580156107fd57506001548111155b151561080857600080fd5b600081815260036020526040902054600160a060020a0316151561082b57600080fd5b5050600090815260066020526040902054600160a060020a031690565b6000805460ff161561085957600080fd5b50600081815260036020526040902054600160a060020a031680151561087e57600080fd5b80600160a060020a031633600160a060020a031614806108c45750600160a060020a038082166000908152600760209081526040808320339094168352929052205460ff165b15156108cf57600080fd5b600082815260066020908152604091829020805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a03878116918217909255835186815293519093918516927f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925928290030190a3505050565b600180548290811061095357fe5b60009182526020909120015461ffff80821692506201000082048116916401000000008104821691660100000000000082048116916801000000000000000081048216916a010000000000000000000082048116916c0100000000000000000000000090041687565b600254600154036000190190565b6000805460ff16156109db57600080fd5b600160a060020a03331660009081526008602052604090205460ff161515610a0257600080fd5b60018310158015610a1557506001548311155b1515610a2057600080fd5b50600082815260036020526040902054600160a060020a0316801515610a4557600080fd5b600160a060020a0382161515610a5a57600080fd5b600160a060020a038181169083161415610a7357600080fd5b610a7e818385611910565b505050565b6000805460ff1615610a9457600080fd5b8460018110158015610aa857506001548111155b1515610ab357600080fd5b600081815260036020526040902054600160a060020a03161515610ad657600080fd5b600160a060020a03331660009081526008602052604090205460ff161515610afd57600080fd5b6001805487908110610b0b57fe5b60009182526020822001925061ffff8635161115610b3f57610b3f8261ffff8735168660005b602002013561ffff16611aee565b600061ffff6020870135161115610b6557610b658261ffff602088013516866001610b31565b600061ffff6040870135161115610b8b57610b8b8261ffff604088013516866002610b31565b600061ffff6060870135161115610bb157610bb18261ffff606088013516866003610b31565b600061ffff6080870135161115610bd757610bd78261ffff608088013516866004610b31565b60008681526003602090815260409182902054825189815261ffff8716928101929092528251600160a060020a03909116927fad883e8a85ce2fd3c84be28c732a56ab850fbb7b42816a3ba303d6831f10687c928290030190a2505050505050565b6000805460ff1615610c4a57600080fd5b8160018110158015610c5e57506001548111155b1515610c6957600080fd5b600081815260036020526040902054600160a060020a03161515610c8c57600080fd5b6000838152600360205260409020548390600160a060020a03908116903316811480610cd2575060008281526006602052604090205433600160a060020a039081169116145b80610d035750600160a060020a038082166000908152600760209081526040808320339094168352929052205460ff165b1515610d0e57600080fd5b600085815260036020526040902054600160a060020a03169350831515610d3457600080fd5b600160a060020a0386161515610d4957600080fd5b600160a060020a0384811690881614610d6157600080fd5b610d6c878787611910565b50505050505050565b60005433600160a060020a039081166101009092041614610d9557600080fd5b60005460ff161515610da657600080fd5b6000805460ff19169055565b60608160008080806040851115610dc857600080fd5b84600b02604051908082528060200260200182016040528015610df5578160200160208202803883390190505b509550600091505b84821015610f9c57878783818110610e1157fe5b602090810292909201356000818152600390935260409092205491955050600160a060020a031615610f915760018054600b8402945085908110610e5157fe5b60009182526020909120018054875191925062010000900461ffff1690879085908110610e7a57fe5b61ffff928316602091820290920101528154875164010000000090910490911690879060018601908110610eaa57fe5b61ffff9283166020918202909201015281548751660100000000000090910490911690879060028601908110610edc57fe5b61ffff92831660209182029092010152815487516801000000000000000090910490911690879060038601908110610f1057fe5b61ffff92831660209182029092010152815487516a010000000000000000000090910490911690879060048601908110610f4657fe5b61ffff92831660209182029092010152815487516c0100000000000000000000000090910490911690879060058601908110610f7e57fe5b61ffff9092166020928302909101909101525b816001019150610dfd565b505050505092915050565b60005460ff1615610fb757600080fd5b610a7e8383836020604051908101604052806000815250611bf4565b6000805481908190819060ff1615610fea57600080fd5b8560018110158015610ffe57506001548111155b151561100957600080fd5b600081815260036020526040902054600160a060020a0316151561102c57600080fd5b600160a060020a03331660009081526008602052604090205460ff16151561105357600080fd5b6000878152600360209081526040808320546005835281842054600160a060020a03909116808552600490935292208054919750919550909350879084908690811061109b57fe5b90600052602060002001541415156110b257600080fd5b825460001901841461110d578254839060001981019081106110d057fe5b906000526020600020015491508183858154811015156110ec57fe5b60009182526020808320909101929092558381526005909152604090208490555b82546000190161111d8482611e81565b506000878152600360209081526040808320805473ffffffffffffffffffffffffffffffffffffffff191690556005825280832083905560028054600101905580518a81529051600160a060020a038916927fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef928290030190a36040805188815261ffff881660208201528151600160a060020a038816927f5efad077d96988d0576292352faaf449e755a9d9d8a734ae4418ffba15233fff928290030190a250505050505050565b6000805433600160a060020a03908116610100909204161461120757600080fd5b50600160a060020a031660009081526008602052604090205460ff1690565b600080548190819060ff161561123b57600080fd5b600160a060020a03331660009081526008602052604090205460ff16151561126257600080fd5b600160a060020a038616151561127757600080fd5b6001549150640100000000821061128d57600080fd5b6001805481019061129e9082611ea5565b5060018054839081106112ad57fe5b6000918252602082200191508590825461ffff191661ffff602092909202929092013516178155846001825463ffff00001916602091909102919091013561ffff166201000002178155846002825465ffff000000001916602091909102919091013561ffff1664010000000002178155846003825467ffff0000000000001916602091909102919091013561ffff16660100000000000002178155846004602002013561ffff168160000160086101000a81548161ffff021916908361ffff16021790555061137f60008784611910565b6040805183815261ffff873581166020808401919091528801358116828401528783013581166060830152861660808201529051600160a060020a038816917f39c3d3801f16dde435b7d047d4943b366f38d2d8b4f12c5d1093db225e2ecdf4919081900360a00190a250949350505050565b600090815260036020526040902054600160a060020a031690565b60005433600160a060020a03908116610100909204161461142d57600080fd5b60005460ff161561143d57600080fd5b6000805460ff19166001179055565b60005433600160a060020a03908116610100909204161461146c57600080fd5b600160a060020a03919091166000908152600860205260409020805460ff1916911515919091179055565b60005433600160a060020a0390811661010090920416146114b757600080fd5b600160a060020a03811615156114cc57600080fd5b60008054604051600160a060020a038085169361010090930416917ff8ccb027dfcd135e000e9d45e6cc2d662578a8825d4c45b5e32e0adf67e79ec691a360008054600160a060020a039092166101000274ffffffffffffffffffffffffffffffffffffffff0019909216919091179055565b6000600160a060020a038216151561155657600080fd5b50600160a060020a031660009081526004602052604090205490565b61157a611ec9565b6000826001811015801561159057506001548111155b151561159b57600080fd5b600081815260036020526040902054600160a060020a031615156115be57600080fd5b60018054859081106115cc57fe5b6000918252602091829020015461ffff80821686526201000082048116928601929092526401000000008104821660408601526601000000000000810482166060860152680100000000000000008104821660808601526a01000000000000000000008104821660a08601526c0100000000000000000000000090041660c0840152509092915050565b60408051808201909152600481527f454c485400000000000000000000000000000000000000000000000000000000602082015290565b60005460ff161561169d57600080fd5b600160a060020a03338116600081815260076020908152604080832094871680845294825291829020805486151560ff199091168117909155825190815291517f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c319281900390910190a35050565b60005460ff1681565b60005460ff161561172457600080fd5b61176085858585858080601f01602080910402602001604051908101604052809392919081815260200183838082843750611bf4945050505050565b5050505050565b6000546101009004600160a060020a031681565b6060806000808080600160a060020a038716151561179857600080fd5b600160a060020a03871660009081526004602090815260409182902080548351818152818402810190930190935295509093508380156117e2578160200160208202803883390190505b5095508260405190808252806020026020018201604052801561180f578160200160208202803883390190505b509450600091505b828210156118d957838281548110151561182d57fe5b9060005260206000200154868381518110151561184657fe5b60209081029091010152835460019085908490811061186157fe5b906000526020600020015481548110151561187857fe5b600091825260209091200180548651919250640100000000810461ffff9081166201000083048216600a02919092166103e8020101908690849081106118ba57fe5b63ffffffff909216602092830290910190910152600190910190611817565b50505050915091565b600160a060020a03918216600090815260076020908152604080832093909416825291909152205460ff1690565b60008080600160a060020a03861615611a2857600084815260056020908152604080832054600160a060020a038a168452600490925290912080549194509250849083908590811061195e57fe5b906000526020600020015414151561197557600080fd5b81546000190183146119d05781548290600019810190811061199357fe5b906000526020600020015490508082848154811015156119af57fe5b60009182526020808320909101929092558281526005909152604090208390555b8154600019016119e08382611e81565b50600084815260066020526040902054600160a060020a031615611a28576000848152600660205260409020805473ffffffffffffffffffffffffffffffffffffffff191690555b6000848152600360209081526040808320805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a038a8116918217909255808552600484528285208054600181018255818752858720018a9055548986526005909452919093206000199092019091559087161515611aa45730611aa6565b865b600160a060020a03167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef866040518082815260200191505060405180910390a3505050505050565b8161ffff1660021415611b1a57825465ffff00000000191664010000000061ffff831602178355610a7e565b8161ffff1660031415611b4a57825467ffff0000000000001916660100000000000061ffff831602178355610a7e565b8161ffff1660041415611b7e57825469ffff000000000000000019166801000000000000000061ffff831602178355610a7e565b8161ffff1660051415611bb65782546bffff0000000000000000000019166a010000000000000000000061ffff831602178355610a7e565b8161ffff1660061415610a7e57825461ffff82166c01000000000000000000000000026dffff00000000000000000000000019909116178355505050565b60008060008460018110158015611c0d57506001548111155b1515611c1857600080fd5b600081815260036020526040902054600160a060020a03161515611c3b57600080fd5b6000868152600360205260409020548690600160a060020a03908116903316811480611c81575060008281526006602052604090205433600160a060020a039081169116145b80611cb25750600160a060020a038082166000908152600760209081526040808320339094168352929052205460ff165b1515611cbd57600080fd5b600088815260036020526040902054600160a060020a03169550851515611ce357600080fd5b600160a060020a0389161515611cf857600080fd5b600160a060020a03868116908b1614611d1057600080fd5b611d1b8a8a8a611910565b883b9450841515611d2b57611e75565b88600160a060020a031663f0b9e5ba8b8a8a6040518463ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018084600160a060020a0316600160a060020a0316815260200183815260200180602001828103825283818151815260200191508051906020019080838360005b83811015611dc3578181015183820152602001611dab565b50505050905090810190601f168015611df05780820380516001836020036101000a031916815260200191505b50945050505050602060405180830381600087803b158015611e1157600080fd5b505af1158015611e25573d6000803e3d6000fd5b505050506040513d6020811015611e3b57600080fd5b505193507ff0b9e5ba00000000000000000000000000000000000000000000000000000000600160e060020a0319851614611e7557600080fd5b50505050505050505050565b815481835581811115610a7e57600083815260209020610a7e918101908301611ee8565b815481835581811115610a7e57600083815260209020610a7e918101908301611f06565b60e0604051908101604052806007906020820280388339509192915050565b6107e491905b80821115611f025760008155600101611eee565b5090565b6107e491905b80821115611f025780546dffffffffffffffffffffffffffff19168155600101611f0c5600a165627a7a72305820f6ba3c935283d670d1658498515bfda3edb44c753ea9ce9b5bc3def8954e0c0c0029"}